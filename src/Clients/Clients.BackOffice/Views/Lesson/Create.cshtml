@model LessonViewModel

@{
    ViewData["Title"] = "New Lesson";
}

<h1>@ViewData["Title"]</h1>

<form method="post" asp-action="create">
    <hr />
    <input type="hidden" asp-for="ReturnUrl" />
    @if (!ViewContext.ModelState.IsValid)
    {
        <div asp-validation-summary="All" class="alert alert-danger">
            <h4>Error:</h4>
        </div>
    }

    <div class="form-group">
        <label asp-for="Name"></label>
        <span asp-validation-for="Name"></span>
        <input asp-for="Name" class="form-control" />
    </div>

    <div class="form-group">
        <label asp-for="Description"></label>
        <span asp-validation-for="Description"></span>
        <textarea asp-for="Description" class="form-control"></textarea>
    </div>

    <div class="form-group">
        <label asp-for="VideoUrl"></label>
        <span asp-validation-for="VideoUrl"></span>
        <input asp-for="VideoUrl" class="form-control" />
    </div>

    <h4>Dialogs</h4>
    <div class="form-group">
        <input id="AddDialogue" class="btn btn-light" type="button" value="Add" />
    </div>

    <div class="form-group dialogues">

    </div>

    <div class="form-group">
        <input type="submit" class="btn btn-primary" value="Create" />
    </div>
</form>

@section scripts {
    <script>
        $(document).ready(function () {
            var i = 0;

            $('#AddDialogue').click(function () {
                var div = $('<div />');
                var characterId = 0;
                var text = "";
                var order = 0;

                var textBox = $('<input />').attr('type', 'text').attr('name', 'Dialogues[' + i + '].Text');
                textBox.val(text);
                div.append(textBox);

                var removeButton = $('<input />').attr('type', 'button').attr('value', 'Remove');
                removeButton.attr('onclick', 'removeDialogue(this)');
                div.append(removeButton);

                $('div.dialogues').append(div);
                i++;
            });
        });

        function removeDialogue(button) {
            $(button).parent().remove();

            var i = 0;
            $('.dialogues input:text').each(function () {
                $(this).attr('name', 'Dialogues[' + i + '].Text');
                i++;
            });
        }
    </script>
}